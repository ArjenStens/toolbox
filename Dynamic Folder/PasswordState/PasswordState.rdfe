{"Name":"Dynamic Folder Export","Objects":[{"Type":"DynamicFolder","Name":"PasswordState","Notes":"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>\n\t\t</title>\n\t\t<style type=\"text/css\">\n\t\t\t.cs2654AE3A{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}\n\t\t\t.cs23FB0664{color:#000000;background-color:transparent;font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<p class=\"cs2654AE3A\"><span class=\"cs23FB0664\">&nbsp;</span></p></body>\n</html>\n","ScriptInterpreter":"powershell","DynamicCredentialScriptInterpreter":"json","Script":"$ErrorActionPreference = \"Stop\"\n$results = Get-PasswordStateResource -uri \"/api/searchpasswords/?search=%&PreventAuditing=true\"\n$credentials = @()\nforeach ($item in $results) {\n    if ($item.Notes -like \"-----BEGIN RSA PRIVATE KEY----*\") {\n        $credentials += [pscustomobject]@{\n            Type           = \"Credential\"\n            Name           = $item.Title\n            Username       = $item.Username\n            Password       = $item.Password\n            ID             = $item.PasswordID\n            KeyFileContent = $item.Notes\n        }\n  \n    }\n    else {\n        $credentials += [pscustomobject]@{\n            Type     = \"Credential\"\n            Name     = $item.Title\n            Username = $item.Username\n            Password = $item.Password\n            ID       = $item.PasswordID\n        }\n   \n    }\n}\n\n\n$final = [pscustomobject]@{\n    Objects = $credentials\n}\n$final | ConvertTo-Json -Depth 100 | Write-Output"}]}