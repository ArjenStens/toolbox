{"Name":"Dynamic Folder Export","Objects":[{"Type":"DynamicFolder","Name":"Current Account","Description":"This returns dynamic objects reflecting data from the current user account.","Notes":"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<head>\r\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>\r\n\t\t</title>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t.cs2654AE3A{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}\r\n\t\t\t.cs4306042E{color:#000000;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:bold;font-style:normal;}\r\n\t\t\t.csC8F6D76{color:#000000;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:normal;font-style:normal;}\r\n\t\t\t.cs15B7AE4B{text-align:left;margin:0pt 0pt 0pt 0pt;list-style-type:disc;color:#000000;background-color:transparent;font-family:Arial;font-size:11pt;font-weight:normal;font-style:normal}\r\n\t\t</style>\r\n\t</head>\r\n\t<body>\r\n\t\t<p class=\"cs2654AE3A\"><span class=\"cs4306042E\">Version:</span><span class=\"csC8F6D76\"> 1.0</span></p><p class=\"cs2654AE3A\"><span class=\"cs4306042E\">Requirements</span></p><p class=\"cs2654AE3A\"><span class=\"csC8F6D76\">&nbsp;</span></p><ul style=\"margin-top:0;margin-bottom:0;\">\r\n\t\t\t<li class=\"cs15B7AE4B\"><span class=\"csC8F6D76\">Working PowerShell installation</span></li><li class=\"cs15B7AE4B\"><span class=\"csC8F6D76\">PowerShell Script Interpreter correctly configured in Royal TS/X</span></li></ul>\r\n\t</body>\r\n</html>\r\n","ScriptInterpreter":"powershell","DynamicCredentialScriptInterpreter":"json","Script":"$ErrorActionPreference = \"Stop\"\r\n\r\n# get data\r\n$account = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name\r\n$domain = $account.split(\"\\\")[0]\r\n$username = $account.split(\"\\\")[1]\r\n\r\n# output objects\r\n@{\r\n    Objects = @(\r\n        @{\r\n            ID = \"CURRENT_DOMUSER\";\r\n            Type = \"Credential\";\r\n            Name = \"Current UserName with domain\";\r\n            Username = $account;\r\n            Password = \"\";\r\n            Path = \"/\";\r\n            IconName = \"VMware Clarity/Core/Avatar Solid\";\r\n            Description = \"This reflects the current logged-on user account, including domain.\";\r\n            CustomProperties = @{\r\n                DOMAIN = $domain;\r\n                USERNAME = $username;\r\n            }\r\n        },\r\n        @{\r\n            ID = \"CURRENT_USERNAME\";\r\n            Type = \"Credential\";\r\n            Name = \"Current UserName without domain\";\r\n            Username = $username;\r\n            Password = \"\";\r\n            Path = \"/\";\r\n            IconName = \"VMware Clarity/Core/Avatar Line\";\r\n            Description = \"This reflects the current logged-on user account, without domain.\";\r\n            CustomProperties = @{\r\n                DOMAIN = $domain;\r\n            }\r\n        }\r\n    )\r\n} | ConvertTo-Json -Depth 10 | Write-Host\r\n"}]}