{"Name":"Dynamic Folder Export","Objects":[{"Type":"DynamicFolder","Name":"Server (LAPS)","CustomProperties":[{"Name":"SearchBase","Type":"Text","Value":"OU=Server,OU=contoso,DC=com"}],"ScriptInterpreter":"powershell","DynamicCredentialScriptInterpreter":"powershell","DynamicCredentialScript":"$ErrorActionPreference = \"Stop\"\n\nImport-Module AdmPwd.PS\n\n$Pass = Get-AdmPwdPassword -Computername $Target.Name$\n\n$JSON = \"\"\n$JSON += \"{`n\"\n$JSON += \"  `\"Username`\" : `\".\\\\Administrator`\",`n\"\n$JSON += \"  `\"Password`\" : `\"$($Pass.Password)`\"`n\"\n$JSON += \"}`n\"\n\nWrite-Host $JSON\n\n\n","Script":"$ErrorActionPreference = \"Stop\"\n\n[string] $JSON = \"{ `\"Objects`\" : [ `n\"\n\n$JSON += \"{`n\"\n$JSON += \" `\"Type`\" : `\"DynamicCredential`\",`n\"\n$JSON += \" `\"Name`\" : `\"Administrator`\",`n\"\n$JSON += \" `\"ID`\" : `\"LAPS`\"`n\"\n$JSON += \"},`n\"\n\nforeach ($comp in (Get-ADComputer -SearchBase $CustomProperty.SearchBase$ -filter *))\n{\n    $JSON += \"{`n\"\n    $JSON += \" `\"Type`\" : `\"RemoteDesktopConnection`\",`n\"\n    $JSON += \" `\"Name`\" : `\"$($comp.Name)`\",`n\"\n    $JSON += \" `\"ComputerName`\" : `\"$($comp.DNSHostName)`\",`n\"\n\t$JSON += \" `\"Path`\" : `\"Connections`\",`n\"\n\t$JSON += \" `\"CredentialID`\" : `\"LAPS`\"`n\"\n    $JSON += \"},`n\"\n}\n\n$JSON = $JSON.Substring(0, $JSON.Length - 2)\n$JSON += \"`n]`n}`n\"\n\nWrite-Host $JSON"}]}